{% extends 'students/base.html' %}
{% block title %}Student Details{% endblock %}
{% block content %}
  <h1>{{ student.name }} ({{ student.roll_no }})</h1>
  <p class="small">Class: {{ student.class_name }} â€¢ DOB: {{ student.dob }}</p>

  <h3>Grades</h3>
  <table class="table small">
    <thead><tr><th>Subject</th><th>Marks</th><th>Date</th></tr></thead>
    <tbody>
    {% for g in grades %}
      <tr><td>{{ g.subject }}</td><td>{{ g.marks }}</td><td>{{ g.date_recorded|date:"Y-m-d H:i" }}</td></tr>
    {% empty %}
      <tr><td colspan="3">No grades</td></tr>
    {% endfor %}
    </tbody>
  </table>

  <h4>Add grade</h4>
  <form method="post" action="{% url 'add_grade' %}">
    {% csrf_token %}
    {{ grade_form.as_p }}
    <button class="btn" type="submit">Add Grade</button>
  </form>

  <hr>

  <h3>Attendance</h3>
  <table class="table small">
    <thead><tr><th>Date</th><th>Present</th></tr></thead>
    <tbody>
    {% for a in attendance %}
      <tr><td>{{ a.date }}</td><td>{{ a.is_present }}</td></tr>
    {% empty %}
      <tr><td colspan="2">No attendance</td></tr>
    {% endfor %}
    </tbody>
  </table>

  <h4>Mark attendance</h4>
  <form method="post" action="{% url 'mark_attendance' %}">
    {% csrf_token %}
    {{ attendance_form.as_p }}
    <button class="btn" type="submit">Save Attendance</button>
  </form>

  <p><a href="{% url 'student_list' %}">Back to list</a></p>
{% endblock %}
